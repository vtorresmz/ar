<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Video AR Interactivo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Librerías -->
  <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.5/dist/mindar-image-aframe.prod.js"></script>html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Iron Man Face AR Interactivo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Librerías -->
  <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.5/dist/mindar-face-aframe.prod.js"></script>

  <style>
    html,body{margin:0;height:100%;overflow:hidden;}
    a-scene{position:fixed;width:100%;height:100%;}
    #ui{position:absolute;z-index:1000;top:10px;left:10px;display:none;}
    #ui button{margin:2px 4px;padding:6px 10px;}
  </style>

  <script>
  document.addEventListener("DOMContentLoaded", ()=>{

    const scene = document.querySelector("a-scene");
    const ui    = document.getElementById("ui");
    const start = document.getElementById("btn-start");
    const stop  = document.getElementById("btn-stop");
    const pause = document.getElementById("btn-pause");
    const play  = document.getElementById("btn-play");

    let arSystem;

    scene.addEventListener("loaded", ()=>{
      arSystem = scene.systems["mindar-image-system"];
      /* Botones una vez que existe el sistema */
      start.onclick = ()=> arSystem.start();
      stop .onclick = ()=> arSystem.stop();
      pause.onclick = ()=> arSystem.pause();
      play .onclick = ()=> arSystem.unpause();
    });

    /* Mostrar controles sólo cuando se detecte la imagen */
    const imageTarget = document.getElementById("image-target");
    imageTarget.addEventListener("targetFound", ()=> {
      ui.style.display = "block";
      // Reproducir el video cuando se encuentre el target
      const video = document.getElementById("arVideo");
      video.play();
    });
    imageTarget.addEventListener("targetLost",  ()=> {
      ui.style.display = "none";
      // Pausar el video cuando se pierda el target
      const video = document.getElementById("arVideo");
      video.pause();
    });

  });
  </script>
</head>

<body>
  <!-- controles -->
  <div id="ui">
    <button id="btn-start">Start</button>
    <button id="btn-pause">Pause</button>
    <button id="btn-play">Unpause</button>
    <button id="btn-stop">Stop</button>
  </div>

  <!-- escena -->
  <a-scene
     mindar-image="imageTargetSrc: ./lentes.mind; autoStart: false"
     embedded
     color-space="sRGB"
     renderer="colorManagement: true, physicallyCorrectLights"
     vr-mode-ui="enabled: false"
     device-orientation-permission-ui="enabled: false">

     <a-assets>
       <video id="arVideo" src="video.mp4" loop muted playsinline></video>
     </a-assets>

     <a-camera position="0 0 0" look-controls="enabled: false"></a-camera>

     <!-- Target de imagen AR -->
     <a-entity id="image-target" mindar-image-target="targetIndex: 0">
       <!-- Video que se mostrará sobre la imagen -->
       <a-video src="#arVideo"
                width="1.2" height="0.8"
                position="0 0 0.1"
                rotation="0 0 0"
                material="depthTest:false">
       </a-video>
     </a-entity>
  </a-scene>
</body>
</html>